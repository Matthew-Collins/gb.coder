' Gambas class file

Inherits TextEditor

Public ProjectFile As ProjectFile
Public ProjectFileObserver As Observer

Public Sub _new(_ProjectFile As ProjectFile)

  With Me
    .ProjectFile = _ProjectFile
    .ProjectFileObserver = New Observer(.ProjectFile, True) As "ProjectFileObserver"

    Select Case .ProjectFile.Type
      Case ProjectTypes.Gambas, ProjectTypes.GambasScript, ProjectTypes.Vb, ProjectTypes.VbCore
        .Highlight = "gambas"
      Case ProjectTypes.Swift, ProjectTypes.SwiftScript
        .Highlight = "c"
    End Select

    .Text = .ProjectFile.LoadText()

    .Font.Name = "Courier 10 Pitch"
    .Font.Size = 9

    .ShowLineNumber = True
    .ShowIcon = True
    .ShowIndent = True
    .ShowCurrent = True

    Select Case .ProjectFile.Type
      Case ProjectTypes.Swift, ProjectTypes.SwiftScript
        .Breakpoints = [0]  'TODO: Change to []
      Case ProjectTypes.Vb, ProjectTypes.VbCore
        .Breakpoints = [4]  'TODO: Change to []
    End Select

  End With

End

Public Sub TextEditor_Click()

  Print "Click"

End

Public Sub ProjectFileObserver_Stopped(LineNumber As Integer)

  Me.StopLine = LineNumber - 1

End

Public Sub ProjectFileObserver_FlushChanges()

  Flush()

End

Public Sub Flush()

  Me.ProjectFile.SaveText(Me.Text)

End
