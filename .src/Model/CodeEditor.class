' Gambas class file

Inherits TextEditor

Public ProjectFile As ProjectFile
Public ProjectFileObserver As Observer

Public Sub _new(_ProjectFile As ProjectFile)

  With Me
    .ProjectFile = _ProjectFile
    .ProjectFileObserver = New Observer(.ProjectFile, True) As "ProjectFileObserver"

    Select Case .ProjectFile.Type
      Case ProjectTypes.Gambas, ProjectTypes.GambasScript, ProjectTypes.Vb, ProjectTypes.VbCore
        .Highlight = "gambas"
      Case ProjectTypes.Swift, ProjectTypes.SwiftScript
        .Highlight = "c"
    End Select

    .Text = .ProjectFile.LoadText()

    '.Font = Fonts["Nato Sans"]

    .ShowLineNumber = True
    .ShowIcon = True
    .ShowIndent = True
    .ShowCurrent = True
    .Breakpoints = [0]  'TODO: Change to []

  End With

End

Public Sub ProjectFileObserver_FlushChanges()

  Flush()

End

Public Sub Flush()

  Me.ProjectFile.SaveText(Me.Text)

End
