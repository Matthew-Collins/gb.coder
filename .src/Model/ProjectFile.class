' Gambas class file

Public Project As Project
Public FileName As String
Public Type As Integer

Public Breakpoints As New Integer[]

Event FlushChanges
Event Stopped(LineNumber As Integer)

Public Sub _new(_Project As Project, _FileName As String, _Type As Integer)

  Me.Project = _Project
  Me.FileName = _FileName
  Me.Type = _Type

End

Public Sub AddTab(Tabs As TabPanel, UseLastTab As Boolean)

  If Not UseLastTab Then
    Tabs.Count += 1
  Endif

  GetEditor(Tabs[Tabs.Count - 1])
  With Tabs[Tabs.Count - 1]
    .Text = FileName
    .Tag = Me
  End With

End

Public Function GetEditor(Container As Container) As CodeEditor

  Return New CodeEditor(Container, Me)

End

Public Function LoadText() As String

  Dim Text As String = ""

  If Exist(Project.RootFolder &/ FileName) Then
    Text = File.Load(Project.RootFolder &/ FileName)
  Endif

  Return Text

End

Public Function SaveText(Text As String)

  File.Save(Project.RootFolder &/ FileName, Text)

End

Public Sub Flush()

  Raise FlushChanges

End

Public Sub StoppedAt(LineNumber As Integer)

  Raise Stopped(LineNumber)

End
